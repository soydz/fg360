<!DOCTYPE html>
<html>
<head>
  <title>STOMP WebSocket Test</title>
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</head>
<body>
  <h2>WebSocket Cliente STOMP</h2>
  <pre id="output"></pre>

  <script>
    // Dirección del servidor de notificaciones
    const socket = new SockJS('http://localhost:8083/ws-alerts');
    const stompClient = Stomp.over(socket);

    stompClient.connect({}, function (frame) {
      log("Conectado: " + frame);

      // ✅ Suscripción al canal usando en el backend
      stompClient.subscribe('/all/alerts', function (message) {
        const alert = JSON.parse(message.body);
        log("Mensaje recibido:\n" + JSON.stringify(alert, null, 2));
      });
    });

    function log(message) {
      document.getElementById('output').textContent += message + '\n';
    }
  </script>
</body>
</html>
